!function e(t,n,o){function r(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return r(n?n:e)},f,f.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(){},{}],2:[function(e,t){t.exports=e(1)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/browserify/lib/_empty.js":1}],3:[function(e,t){function n(){}var o=t.exports={};o.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var o=[];if(t){var r=document.createElement("div"),i=new MutationObserver(function(){var e=o.slice();o.length=0,e.forEach(function(e){e()})});return i.observe(r,{attributes:!0}),function(e){o.length||r.setAttribute("yes","no"),o.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),o.length>0)){var n=o.shift();n()}},!0),function(e){o.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=n,o.addListener=n,o.once=n,o.off=n,o.removeListener=n,o.removeAllListeners=n,o.emit=n,o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){"use strict";function o(e){for(var t in e)return!1;return!0}function r(e){return"string"==typeof e||e instanceof String}function i(e){return!isNaN(e)}function s(e){return"undefined"==typeof e}function u(e,t){return delete t._rev,t.$createdAt=(new Date).toJSON(),t.$id?(t._id=t.$id+"_"+t.$createdAt,e.put(t).then(function(e){return e.$id=t.$id,e})["catch"](function(e){if(409!==e.status)throw e})):e.post(t).then(function(e){return e.$id=e.id,e})}function c(e,t){e.get(t.id).then(function(e){var t=e.$id?e.$id:e._id;n.wasDeleted(t)||(e.$deleted?(n.markDeletion(t),n.delta.emit("delete",t)):e.$id?n.delta.emit("update",e):(e.$id=t,n.delta.emit("create",e)))})}function a(e){e.delta.removeAllListeners()}function f(e,t){var n={},o=!1;for(var r in t)e[r]!==t[r]&&(o=!0,n[r]=t[r]);return o?n:null}function l(e,t){return e.get(t).then(function(t){return e.remove(t)})["catch"](function(e){if(404!==e.status)throw e})}function d(e,t,n){var o=[];return t.rows.forEach(function(t){n[t.doc.$id]&&o.push(l(e,t.id))}),m.all(o)}function p(e,t,o,r){return e.get(t.doc._id).then(function(i){if(t.doc.$id||(t.doc.$id=t.doc._id),t.doc.$deleted||r[t.doc.$id])return r[t.doc.$id]=!0,e.remove(i);if(o[t.doc.$id]){var s=!1;for(var u in t.doc)if("undefined"==typeof o[t.doc.$id][u]){s=!0;break}if(!s)return e.remove(i);o[t.doc.$id]=n.merge(o[t.doc.$id],t.doc)}else o[t.doc.$id]=t.doc})}var h=e("./pouch-utils"),m=h.Promise,v=e("events");n.delta=new v.EventEmitter,n.deltaInit=function(){this.on("create",function(e){c(this,e)}),this.on("destroyed",function(){a(this)})},n.clone=function(e){return JSON.parse(JSON.stringify(e))},n.merge=function(e,t){var n={};for(var o in e)n[o]=e[o];for(o in t)n[o]=t[o];return n},n.save=function(e){return u(this,e)},n["delete"]=function(e){var t=r(e)||i(e)?e:e.$id;if(s(t))throw new Error("missing $id");return u(this,{$id:t,$deleted:!0})},n.all=function(){var e=this,t={},o={};return e.allDocs({include_docs:!0}).then(function(e){return e.rows.forEach(function(e){e.doc.$id||(e.doc.$id=e.doc._id),e.doc.$deleted?(delete t[e.doc.$id],o[e.doc.$id]=!0):o[e.doc.$id]||(t[e.doc.$id]=t[e.doc.$id]?n.merge(t[e.doc.$id],e.doc):e.doc)}),t})};var y={};n.wasDeleted=function(e){return y[e]?!0:!1},n.markDeletion=function(e){y[e]=!0},n.saveChanges=function(e,t){var n=this,o=f(e,t);return null!==o?(o.$id=e.$id,n.save(o).then(function(){return o})):m.resolve()},n.getAndRemove=function(e){return l(this,e)},n.cleanup=function(){var e=this;return e.allDocs({include_docs:!0}).then(function(t){var n={},r={},i=m.resolve();return t.rows.sort(function(e,t){return e.doc.$createdAt<t.doc.$createdAt}),t.rows.forEach(function(t){i=i.then(function(){return p(e,t,n,r)})}),i.then(function(){return o(r)?void 0:d(e,t,r)})})},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":23,events:24}],5:[function(e,t){"use strict";function n(){}t.exports=n},{}],6:[function(e,t){"use strict";function n(e){function t(e,t){function o(e){a[t]=e,++f===n&!c&&(c=!0,u.resolve(d,a))}i(e).then(o,function(e){c||(c=!0,u.reject(d,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return r(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=new Array(n),f=0,l=-1,d=new o(s);++l<n;)t(e[l],l);return d}var o=e("./promise"),r=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],7:[function(e,t,n){"use strict";function o(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var r=e("./tryCatch"),i=e("./resolveThenable"),s=e("./states");n.resolve=function(e,t){var u=r(o,t);if("error"===u.status)return n.reject(e,u.value);var c=u.value;if(c)i.safely(e,c);else{e.state=s.FULFILLED,e.outcome=t;for(var a=-1,f=e.queue.length;++a<f;)e.queue[a].callFulfilled(t)}return e},n.reject=function(e,t){e.state=s.REJECTED,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":14,"./states":15,"./tryCatch":16}],8:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all"),n.race=e("./race")},{"./all":6,"./promise":9,"./race":11,"./reject":12,"./resolve":13}],9:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=s.PENDING,this.queue=[],this.outcome=void 0,e!==r&&i.safely(this,e)}var o=e("./unwrap"),r=e("./INTERNAL"),i=e("./resolveThenable"),s=e("./states"),u=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s.FULFILLED||"function"!=typeof t&&this.state===s.REJECTED)return this;var i=new n(r);if(this.state!==s.PENDING){var c=this.state===s.FULFILLED?e:t;o(i,c,this.outcome)}else this.queue.push(new u(i,e,t));return i}},{"./INTERNAL":5,"./queueItem":10,"./resolveThenable":14,"./states":15,"./unwrap":17}],10:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var o=e("./handlers"),r=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){r(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){o.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){r(this.promise,this.onRejected,e)}},{"./handlers":7,"./unwrap":17}],11:[function(e,t){"use strict";function n(e){function t(e){i(e).then(function(e){c||(c=!0,u.resolve(f,e))},function(e){c||(c=!0,u.reject(f,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return r(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=-1,f=new o(s);++a<n;)t(e[a]);return f}var o=e("./promise"),r=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],12:[function(e,t){"use strict";function n(e){var t=new o(r);return i.reject(t,e)}var o=e("./promise"),r=e("./INTERNAL"),i=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9}],13:[function(e,t){"use strict";function n(e){if(e)return e instanceof o?e:i.resolve(new o(r),e);var t=typeof e;switch(t){case"boolean":return s;case"undefined":return c;case"object":return u;case"number":return a;case"string":return f}}var o=e("./promise"),r=e("./INTERNAL"),i=e("./handlers");t.exports=n;var s=i.resolve(new o(r),!1),u=i.resolve(new o(r),null),c=i.resolve(new o(r),void 0),a=i.resolve(new o(r),0),f=i.resolve(new o(r),"")},{"./INTERNAL":5,"./handlers":7,"./promise":9}],14:[function(e,t,n){"use strict";function o(e,t){function n(t){u||(u=!0,r.reject(e,t))}function o(t){u||(u=!0,r.resolve(e,t))}function s(){t(o,n)}var u=!1,c=i(s);"error"===c.status&&n(c.value)}var r=e("./handlers"),i=e("./tryCatch");n.safely=o},{"./handlers":7,"./tryCatch":16}],15:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],16:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(o){n.status="error",n.value=o}return n}t.exports=n},{}],17:[function(e,t){"use strict";function n(e,t,n){o(function(){var o;try{o=t(n)}catch(i){return r.reject(e,i)}o===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,o)})}var o=e("immediate"),r=e("./handlers");t.exports=n},{"./handlers":7,immediate:18}],18:[function(e,t){"use strict";function n(){r=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}function o(e){1!==u.push(e)||r||i()}for(var r,i,s=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],u=[],c=-1,a=s.length;++c<a;)if(s[c]&&s[c].test&&s[c].test()){i=s[c].install(n);break}t.exports=o},{"./messageChannel":19,"./mutation.js":20,"./nextTick":2,"./stateChange":21,"./timeout":22}],19:[function(e,t,n){(function(e){"use strict";n.test=function(){return e.setImmediate?!1:"undefined"!=typeof e.MessageChannel},n.install=function(t){var n=new e.MessageChannel;return n.port1.onmessage=t,function(){n.port2.postMessage(0)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t,n){(function(e){"use strict";var t=e.MutationObserver||e.WebKitMutationObserver;n.test=function(){return t},n.install=function(n){var o=0,r=new t(n),i=e.document.createTextNode("");return r.observe(i,{characterData:!0}),function(){i.data=o=++o%2}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t,n){(function(e){"use strict";n.test=function(){return"document"in e&&"onreadystatechange"in e.document.createElement("script")},n.install=function(t){return function(){var n=e.document.createElement("script");return n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n),t}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],23:[function(e,t,n){(function(t,o){"use strict";var r;r="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof o.Promise?o.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),o=-1;++o<t;)n[o]=arguments[o];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(o){var i,s=this,u="function"==typeof o[o.length-1]?o.pop():!1;u&&(i=function(e,n){t.nextTick(function(){u(e,n)})});var c=new r(function(t,r){try{var i=n.once(function(e,n){e?r(e):t(n)});o.push(i),e.apply(s,o)}catch(u){r(u)}});return i&&c.then(function(e){i(null,e)},i),c.cancel=function(){return this},c})},n.inherits=e("inherits"),n.Promise=r}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3,inherits:25,lie:8}],24:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function r(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!r(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,r,u,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,u=new Array(r-1),c=1;r>c;c++)u[c-1]=arguments[c];n.apply(this,u)}else if(i(n)){for(r=arguments.length,u=new Array(r-1),c=1;r>c;c++)u[c-1]=arguments[c];for(a=n.slice(),r=a.length,c=0;r>c;c++)a[c].apply(this,u)}return!0},n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned){var r;r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,r,s,u;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(u=s;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?o(e._events[t])?1:e._events[t].length:0}},{}],25:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],26:[function(e,t,n){"use strict";function o(e){return JSON.parse(JSON.stringify(e))}function r(e,t){var n,o={};if(e)for(n in e)o[n]=e[n];if(t)for(n in t)o[n]=t[n];return o}var i=e("./pouch-utils"),s=e("events"),u=1e3,c=3e5,a=1.1;n.persist=function(e){function t(){return T.info().then(function(e){var t=L.opts.changes,n={since:e.update_seq,live:!0};t.opts&&(n=r(n,t.opts)),L.changes=T.changes(n)})}function n(e,t){t.forEach(function(t){var n=e[t.method];n.call(e,t.event,t.listener)})}function f(e){return Math.min(L.maxTimeout,Math.floor(e*L.backoff))}function l(){L.connected=!1,L.emit("disconnect")}function d(e,t){if(405===e.status){var n=N[t];n.connected=!1,n.retryTimeout=f(n.retryTimeout),setTimeout(t===L.TO?g:w,n.retryTimeout),L.connected&&l()}}function p(){L.connected=!0,L.emit("connect")}function h(e){var t=N[e];t.connected=!0,t.retryTimeout=L.startingTimeout,m(e),N[L.TO].connected&&N[L.FROM].connected&&p()}function m(e){var t=e===L.TO?L.to:L.from,n=N[e].connectListener;t.removeListener("change",n),t.removeListener("complete",n),t.removeListener("uptodate",n)}function v(e,t,o){e.on("error",function(e){d(e,t)}),N[t].connectListener=function(){h(t)};var r=N[t].connectListener;e.once("change",r).once("complete",r).once("uptodate",r),o&&n(e,o)}function y(e){var t=e===L.TO?L.opts.to:L.opts.from,n=e===L.TO?T.replicate.to:T.replicate.from,o={live:!0},i=t.url?t.url:L.opts.url;t.opts&&(o=r(o,t.opts)),e===L.TO?x():E();var s=n(i,o,t.onErr);e===L.TO?L.to=s:L.from=s,v(s,e,t.listeners)}function g(){y(L.TO)}function w(){y(L.FROM)}function b(e){N[L.TO].replicating||e!==L.BOTH&&e!==L.TO||(N[L.TO].replicating=!0,g()),N[L.FROM].replicating||e!==L.BOTH&&e!==L.FROM||(N[L.FROM].replicating=!0,w())}function _(){L.changes&&L.changes.cancel()}function x(){L.to&&L.to.cancel()}function E(){L.from&&L.from.cancel()}var T=this,L=new s.EventEmitter;L.TO=1,L.FROM=2,L.BOTH=3,L.opts={changes:{},to:{},from:{}},L.config=function(e){for(var t in e)L.opts[t]=e[t]},e&&L.config(e),L.startingTimeout=e&&e.startingTimeout?e.startingTimeout:u,L.maxTimeout=e&&e.maxTimeout?e.maxTimeout:c,L.backoff=e&&e.backoff?e.backoff:a,L.connected=!1;var D={retryTimeout:L.startingTimeout,replicating:!1,connected:!1},N={},$=!1;return N[L.TO]=D,N[L.FROM]=o(D),L.start=function(e){return e=e?e:L.BOTH,$?new i.Promise(function(){b(e)}):t().then(function(){$=!0,b(e)})},L.cancel=function(){_(),x(),E()},L.stop=function(e){e=e?e:L.BOTH,(e===L.BOTH||e===L.TO)&&(N[L.TO].replicating=!1,N[L.TO].connected=!1,x()),(e===L.BOTH||e===L.FROM)&&(N[L.FROM].replicating=!1,N[L.FROM].connected=!1,E()),N[L.TO].replicating||N[L.FROM].replicating||_(),l()},e&&!e.manual&&L.start(),L},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":45,events:24}],27:[function(e,t){t.exports=e(5)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/INTERNAL.js":5}],28:[function(e,t){t.exports=e(6)},{"./INTERNAL":27,"./handlers":29,"./promise":31,"./reject":34,"./resolve":35,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/all.js":6}],29:[function(e,t){t.exports=e(7)},{"./resolveThenable":36,"./states":37,"./tryCatch":38,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/handlers.js":7}],30:[function(e,t){t.exports=e(8)},{"./all":28,"./promise":31,"./race":33,"./reject":34,"./resolve":35,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/index.js":8}],31:[function(e,t){t.exports=e(9)},{"./INTERNAL":27,"./queueItem":32,"./resolveThenable":36,"./states":37,"./unwrap":39,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/promise.js":9}],32:[function(e,t){t.exports=e(10)},{"./handlers":29,"./unwrap":39,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/queueItem.js":10}],33:[function(e,t){t.exports=e(11)},{"./INTERNAL":27,"./handlers":29,"./promise":31,"./reject":34,"./resolve":35,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/race.js":11}],34:[function(e,t){t.exports=e(12)},{"./INTERNAL":27,"./handlers":29,"./promise":31,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/reject.js":12}],35:[function(e,t){t.exports=e(13)},{"./INTERNAL":27,"./handlers":29,"./promise":31,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/resolve.js":13}],36:[function(e,t){t.exports=e(14)},{"./handlers":29,"./tryCatch":38,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/resolveThenable.js":14}],37:[function(e,t){t.exports=e(15)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/states.js":15}],38:[function(e,t){t.exports=e(16)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/tryCatch.js":16}],39:[function(e,t){t.exports=e(17)},{"./handlers":29,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/lib/unwrap.js":17,immediate:40}],40:[function(e,t){t.exports=e(18)},{"./messageChannel":41,"./mutation.js":42,"./nextTick":2,"./stateChange":43,"./timeout":44,"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/node_modules/immediate/lib/index.js":18}],41:[function(e,t){t.exports=e(19)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/node_modules/immediate/lib/messageChannel.js":19}],42:[function(e,t){t.exports=e(20)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/node_modules/immediate/lib/mutation.js":20}],43:[function(e,t){t.exports=e(21)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/node_modules/immediate/lib/stateChange.js":21}],44:[function(e,t){t.exports=e(22)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/node_modules/lie/node_modules/immediate/lib/timeout.js":22}],45:[function(e,t){t.exports=e(23)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/delta-pouch/pouch-utils.js":23,_process:3,inherits:25,lie:30}],46:[function(e){"use strict";var t=e("../angular"),n=(e("../index.js"),t.module("factoryng"));n.factory("DeltaPouchyng",["$q","$timeout",e("./delta-pouchyng")])},{"../angular":49,"../index.js":50,"./delta-pouchyng":47}],47:[function(e,t){"use strict";var n=e("../yng-utils"),o=e("./pouchyng-common"),r=e("delta-pouch");t.exports=function(t,i){var s=new o(t,i),u=new n(t);if("undefined"!=typeof window&&window.PouchDB)var c=window.PouchDB;else var c=e("pouchdb");return c.plugin(r),function(e,t,n){function o(e){delete e._rev,a.yng.createDoc(e)}function r(e){delete e._rev;var t=a.yng.get(e.$id),n=a.db.merge(t,e);n.$priority!==t.$priority?a.yng.moveDoc(n):a.yng.updateDoc(n)}function c(e){a.yng.removeDoc(e)}var a=new s(e,t,n,"deltapouchyng");a.copyApi(this),a.map=function(){return a.db.all().then(function(e){u.forEach(e,function(e){delete e._rev,a.yng.push(e)})})},a.registerListeners=function(){var e=c;a.db.deltaInit(),a.db.delta.on("create",o).on("update",r).on("delete",e)},this.create=function(e){return i(function(){return a.yng.setPriorityIfNeeded(e),a.db.save(e).then(function(t){return e.$id=t.$id,a.yng.push(e),e})})},this.update=function(e){return i(function(){var t=a.yng.get(e.$id);return a.db.saveChanges(t,e).then(function(n){var o=a.db.merge(t,n);return a.yng.set(o),e})})},this.remove=function(e){return i(function(){return a.db["delete"](e).then(function(e){return a.yng.remove(e.$id)})})},this.setPriority=function(e,t){return i(function(){var n=a.yng.toId(e),o=a.yng.get(n),r=u.clone(o);return r.$priority=t,a.db.saveChanges(o,r).then(function(){return a.yng.moveDoc(r),o})})},this.cleanup=function(){return a.db.cleanup()}}}},{"../yng-utils":51,"./pouchyng-common":48,"delta-pouch":4,pouchdb:1}],48:[function(e,t){"use strict";var n=e("../yng-utils"),o=e("../yng"),r=e("pouchdb-persist");t.exports=function(t,i){var s=new o(t,i),u=new n(t);if("undefined"!=typeof window&&window.PouchDB)var c=window.PouchDB;else var c=e("pouchdb");return c.plugin(r),function(e,n,o,r){function a(e){e&&m.yng.error(e)}function f(){m.yng.emit("uptodate")}function l(e){return function(){return m.map().then(function(){return m.yng.sortIfNeeded(),m.yng.bindModel(m.yng.scope).then(e.resolve)})}}function d(e){return[{method:"once",event:"uptodate",listener:l(e)},{method:"on",event:"uptodate",listener:f},{method:"once",event:"error",listener:l(e)},{method:"on",event:"complete",listener:f}]}function p(){var e=t.defer();return m.persist=m.db.persist({url:m.yng.url+"/"+(u.get(m.yng.props,"user")?m.yng.props.user:m.yng.name),manual:!0,changes:{opts:u.get(m.yng.props,"changes","opts")},to:{opts:u.get(m.yng.props,"to","opts"),onErr:a},from:{opts:u.get(m.yng.props,"from","opts"),onErr:a,listeners:d(e)}}),m.registerListeners(),m.persist.start(),e.promise}function h(){var e=new c(m.yng.url+"/"+(u.get(m.yng.props,"user")?m.yng.props.user:m.yng.name));return u.doAndOnce(function(){return e.destroy()},"destroyed",e)}var m=this;this.yng=new s(e,n,o);var v={opts:{filter:function(e){return 0!==e._id.indexOf("_design")}}};this.yng.props={changes:v,to:v,from:v},this.db=null,this.persist=null;var y=m.yng.name+"_"+r;this.db=new c(y),this.provider=function(){return m.db},this.bind=function(e){return m.yng.bound()?m.yng.bindModel(e):(m.db.setMaxListeners(20),m.yng.scope=e,m.db.on("error",m.yng.error),i(function(){return p()}))},this.cancel=function(){this.persist.cancel()},this.destroy=function(e){m.cancel();var n=u.doAndOnce(function(){return m.db.destroy()},"destroyed",this.db),o=[n];return e||o.push(h()),t.all(o).then(function(){return m.yng.destroy()})},this.copyApi=function(e){m.yng.copyApi(e);var t=["provider","bind","destroy"];u.copyFns(t,m,e)}}}},{"../yng":52,"../yng-utils":51,pouchdb:1,"pouchdb-persist":26}],49:[function(e,t){e("angular"),t.exports=angular},{angular:1}],50:[function(e){"use strict";var t=e("./angular"),n=t.module("factoryng",[]);n.service("yngutils",["$q",e("./yng-utils")]),n.factory("Yng",["$q","$timeout",e("./yng")])},{"./angular":49,"./yng":52,"./yng-utils":51}],51:[function(e,t){"use strict";t.exports=function(e){this.ASC=1,this.DESC=2,this.replace=function(e,t){for(var n in e)this.notDefined(t[n])&&delete e[n];for(n in t)e[n]=t[n]},this.isString=function(e){return"string"==typeof e||e instanceof String},this.isNumeric=function(e){return!isNaN(e)},this.notDefined=function(e){return"undefined"==typeof e},this.isFunction=function(e){return"function"==typeof e},this.clone=function(e){return JSON.parse(JSON.stringify(e))},this.copyFns=function(e,t,n){e.forEach(function(e){n[e]=function(){return t[e].apply(t,arguments)}})},this.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n,e)},this.doAndOnce=function(t,n,o){var r=e.defer(),i=e.defer();return o.once(n,function(){var e=arguments;return r.promise.then(function(t){i.resolve({action:t,event:e})})}),t().then(function(){return r.resolve(arguments),i.promise})},this.merge=function(e,t){var n,o={};if(e)for(n in e)o[n]=e[n];if(t)for(n in t)o[n]=t[n];return o},this.get=function(){if(arguments&&"undefined"!=typeof arguments[0]){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];if(null===e||"undefined"==typeof e[n])return;e=e[n]}return e}}}},{}],52:[function(e,t){"use strict";var n=e("inherits"),o=e("events").EventEmitter,r=e("./yng-utils");t.exports=function(e,t){var i=0,s=new r(e),u=function(e,t,n){this.name=e,this.url=t,this.sortBy=n,this.model=[],this.map={},this.sorting=!1,this.scope=null,this.props={}};n(u,o);var c=100,a=function(e){return function(t,n){var o=t.$priority-n.$priority;return e===s.DESC?-o:o}};return u.prototype.sortIfNeeded=function(){this.sortBy&&this.model.sort(this.sortBy===s.ASC||this.sortBy===s.DESC?a(this.sortBy):this.sortBy)},u.prototype.sortSoonIfNeeded=function(){if(!this.sorting){this.sorting=!0;var e=this;t(function(){e.sortIfNeeded(),e.sorting=!1},c)}},u.prototype.get=function(e){return this.map[e]},u.prototype.at=function(e){return this.model[e]},u.prototype.set=function(e){this.exists(e.$id)&&s.replace(this.get(e.$id),e)},u.prototype.setProperty=function(e,t,n){this.map[e][t]=n},u.prototype.exists=function(e){return this.map[e]?!0:!1},u.prototype.push=function(e){this.exists(e.$id)||(this.map[e.$id]=e,this.model.push(e))},u.prototype.remove=function(e){var t=this.map[e];return t&&(this.model.splice(this.model.indexOf(t),1),delete this.map[e]),t},u.prototype.length=function(){return this.model.length},u.prototype.bindModel=function(e){var n=this;return t(function(){return n.scope=e,e[n.name]=n.model,n.model})},u.prototype.bound=function(){return this.scope&&this.scope[this.name]?!0:!1},u.prototype.applyFactory=function(e){var t=this;return function(){return e.apply(t,arguments)}},u.prototype.createDoc=function(e){var n=this;return t(function(){return n.push(e),n.emit("create",e),e})},u.prototype.updateDoc=function(e){var n=this;return t(function(){return n.set(e),n.emit("update",e),e})},u.prototype.removeDoc=function(e){var n=this;return t(function(){var t=n.toId(e),o=n.remove(t);return n.emit("remove",o),o})},u.prototype.moveDoc=function(e){var n=this;return t(function(){return n.get(e.$id).$priority!==e.$priority&&(n.set(e),n.sortSoonIfNeeded()),n.emit("move",e),e})},u.prototype.setPriorityIfNeeded=function(e){s.notDefined(e.$priority)&&(e.$priority=this.length())},u.prototype.toId=function(e){var t=s.isString(e)||s.isNumeric(e)?e:e.$id;if(s.notDefined(t))throw new Error("missing $id");return t},u.prototype.forEach=function(e,t){return this.model.forEach(e,t)},u.prototype.cleanup=function(){return e.when()},u.prototype.provider=function(){return null},u.prototype.destroy=function(){return this.removeAllListeners(),this.model=[],this.map={},e.when()},u.prototype.error=function(e){this.emit("error",e)},u.prototype.nextId=function(){return++i},u.prototype.properties=function(e){return"undefined"==typeof e?this.props:void(this.props=e)},u.prototype.copyApi=function(e){var t=["sortIfNeeded","sortSoonIfNeeded","get","at","set","setProperty","exists","push","remove","length","forEach","cleanup","provider","destroy","bound","properties","on","once","removeListener"];s.copyFns(t,this,e)},u}},{"./yng-utils":51,events:24,inherits:25}]},{},[46]);