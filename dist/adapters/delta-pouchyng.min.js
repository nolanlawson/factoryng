!function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(){},{}],2:[function(e,t){t.exports=e(1)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/browserify/lib/_empty.js":1}],3:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var o=document.createElement("div"),i=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return i.observe(o,{attributes:!0}),function(e){r.length||o.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){"use strict";function r(e){for(var t in e)return!1;return!0}function o(e){return"string"==typeof e||e instanceof String}function i(e){return!isNaN(e)}function s(e){return"undefined"==typeof e}function u(e,t){return delete t._rev,t.$createdAt=(new Date).toJSON(),t.$id?(t._id=t.$id+"_"+t.$createdAt,e.put(t).then(function(e){return e.$id=t.$id,e})["catch"](function(e){if(409!==e.status)throw e})):e.post(t).then(function(e){return e.$id=e.id,e})}function c(e,t){e.get(t.id).then(function(e){var t=e.$id?e.$id:e._id;n.wasDeleted(t)||(e.$deleted?(n.markDeletion(t),n.delta.emit("delete",t)):e.$id?n.delta.emit("update",e):(e.$id=t,n.delta.emit("create",e)))})}function a(e){e.delta.removeAllListeners()}function f(e,t){var n={},r=!1;for(var o in t)e[o]!==t[o]&&(r=!0,n[o]=t[o]);return r?n:null}function d(e,t){return e.get(t).then(function(t){return e.remove(t)})["catch"](function(e){if(404!==e.status)throw e})}function l(e,t,n){var r=[];return t.rows.forEach(function(t){n[t.doc.$id]&&r.push(d(e,t.id))}),v.all(r)}function h(e,t,r,o){return e.get(t.doc._id).then(function(i){if(t.doc.$id||(t.doc.$id=t.doc._id),t.doc.$deleted||o[t.doc.$id])return o[t.doc.$id]=!0,e.remove(i);if(r[t.doc.$id]){var s=!1;for(var u in t.doc)if("undefined"==typeof r[t.doc.$id][u]){s=!0;break}if(!s)return e.remove(i);r[t.doc.$id]=n.merge(r[t.doc.$id],t.doc)}else r[t.doc.$id]=t.doc})}var p=e("./pouch-utils"),v=p.Promise,y=e("events");n.delta=new y.EventEmitter,n.deltaInit=function(){this.on("create",function(e){c(this,e)}),this.on("destroyed",function(){a(this)})},n.clone=function(e){return JSON.parse(JSON.stringify(e))},n.merge=function(e,t){var n={};for(var r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n},n.save=function(e){return u(this,e)},n["delete"]=function(e){var t=o(e)||i(e)?e:e.$id;if(s(t))throw new Error("missing $id");return u(this,{$id:t,$deleted:!0})},n.all=function(){var e=this,t={},r={};return e.allDocs({include_docs:!0}).then(function(e){return e.rows.forEach(function(e){e.doc.$id||(e.doc.$id=e.doc._id),e.doc.$deleted?(delete t[e.doc.$id],r[e.doc.$id]=!0):r[e.doc.$id]||(t[e.doc.$id]=t[e.doc.$id]?n.merge(t[e.doc.$id],e.doc):e.doc)}),t})};var m={};n.wasDeleted=function(e){return m[e]?!0:!1},n.markDeletion=function(e){m[e]=!0},n.saveChanges=function(e,t){var n=this,r=f(e,t);return null!==r?(r.$id=e.$id,n.save(r).then(function(){return r})):v.resolve()},n.getAndRemove=function(e){return d(this,e)},n.cleanup=function(){var e=this;return e.allDocs({include_docs:!0}).then(function(t){var n={},o={},i=v.resolve();return t.rows.sort(function(e,t){return e.doc.$createdAt<t.doc.$createdAt}),t.rows.forEach(function(t){i=i.then(function(){return h(e,t,n,o)})}),i.then(function(){return r(o)?void 0:l(e,t,o)})})},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":23,events:24}],5:[function(e,t){"use strict";function n(){}t.exports=n},{}],6:[function(e,t){"use strict";function n(e){function t(e,t){function r(e){a[t]=e,++f===n&!c&&(c=!0,u.resolve(l,a))}i(e).then(r,function(e){c||(c=!0,u.reject(l,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=new Array(n),f=0,d=-1,l=new r(s);++d<n;)t(e[d],d);return l}var r=e("./promise"),o=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],7:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),i=e("./resolveThenable"),s=e("./states");n.resolve=function(e,t){var u=o(r,t);if("error"===u.status)return n.reject(e,u.value);var c=u.value;if(c)i.safely(e,c);else{e.state=s.FULFILLED,e.outcome=t;for(var a=-1,f=e.queue.length;++a<f;)e.queue[a].callFulfilled(t)}return e},n.reject=function(e,t){e.state=s.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":14,"./states":15,"./tryCatch":16}],8:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all"),n.race=e("./race")},{"./all":6,"./promise":9,"./race":11,"./reject":12,"./resolve":13}],9:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=s.PENDING,this.queue=[],this.outcome=void 0,e!==o&&i.safely(this,e)}var r=e("./unwrap"),o=e("./INTERNAL"),i=e("./resolveThenable"),s=e("./states"),u=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s.FULFILLED||"function"!=typeof t&&this.state===s.REJECTED)return this;var i=new n(o);if(this.state!==s.PENDING){var c=this.state===s.FULFILLED?e:t;r(i,c,this.outcome)}else this.queue.push(new u(i,e,t));return i}},{"./INTERNAL":5,"./queueItem":10,"./resolveThenable":14,"./states":15,"./unwrap":17}],10:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var r=e("./handlers"),o=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){r.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},{"./handlers":7,"./unwrap":17}],11:[function(e,t){"use strict";function n(e){function t(e){i(e).then(function(e){c||(c=!0,u.resolve(f,e))},function(e){c||(c=!0,u.reject(f,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=-1,f=new r(s);++a<n;)t(e[a]);return f}var r=e("./promise"),o=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9,"./reject":12,"./resolve":13}],12:[function(e,t){"use strict";function n(e){var t=new r(o);return i.reject(t,e)}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n},{"./INTERNAL":5,"./handlers":7,"./promise":9}],13:[function(e,t){"use strict";function n(e){if(e)return e instanceof r?e:i.resolve(new r(o),e);var t=typeof e;switch(t){case"boolean":return s;case"undefined":return c;case"object":return u;case"number":return a;case"string":return f}}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n;var s=i.resolve(new r(o),!1),u=i.resolve(new r(o),null),c=i.resolve(new r(o),void 0),a=i.resolve(new r(o),0),f=i.resolve(new r(o),"")},{"./INTERNAL":5,"./handlers":7,"./promise":9}],14:[function(e,t,n){"use strict";function r(e,t){function n(t){u||(u=!0,o.reject(e,t))}function r(t){u||(u=!0,o.resolve(e,t))}function s(){t(r,n)}var u=!1,c=i(s);"error"===c.status&&n(c.value)}var o=e("./handlers"),i=e("./tryCatch");n.safely=r},{"./handlers":7,"./tryCatch":16}],15:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],16:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=n},{}],17:[function(e,t){"use strict";function n(e,t,n){r(function(){var r;try{r=t(n)}catch(i){return o.reject(e,i)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var r=e("immediate"),o=e("./handlers");t.exports=n},{"./handlers":7,immediate:18}],18:[function(e,t){"use strict";function n(){o=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}o=!1}function r(e){1!==u.push(e)||o||i()}for(var o,i,s=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],u=[],c=-1,a=s.length;++c<a;)if(s[c]&&s[c].test&&s[c].test()){i=s[c].install(n);break}t.exports=r},{"./messageChannel":19,"./mutation.js":20,"./nextTick":2,"./stateChange":21,"./timeout":22}],19:[function(e,t,n){(function(e){"use strict";n.test=function(){return e.setImmediate?!1:"undefined"!=typeof e.MessageChannel},n.install=function(t){var n=new e.MessageChannel;return n.port1.onmessage=t,function(){n.port2.postMessage(0)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t,n){(function(e){"use strict";var t=e.MutationObserver||e.WebKitMutationObserver;n.test=function(){return t},n.install=function(n){var r=0,o=new t(n),i=e.document.createTextNode("");return o.observe(i,{characterData:!0}),function(){i.data=r=++r%2}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(e,t,n){(function(e){"use strict";n.test=function(){return"document"in e&&"onreadystatechange"in e.document.createElement("script")},n.install=function(t){return function(){var n=e.document.createElement("script");return n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n),t}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],23:[function(e,t,n){(function(t,r){"use strict";var o;o="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof r.Promise?r.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(r){var i,s=this,u="function"==typeof r[r.length-1]?r.pop():!1;u&&(i=function(e,n){t.nextTick(function(){u(e,n)})});var c=new o(function(t,o){try{var i=n.once(function(e,n){e?o(e):t(n)});r.push(i),e.apply(s,r)}catch(u){o(u)}});return i&&c.then(function(e){i(null,e)},i),c.cancel=function(){return this},c})},n.inherits=e("inherits"),n.Promise=o}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3,inherits:25,lie:8}],24:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,u,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,u=new Array(o-1),c=1;o>c;c++)u[c-1]=arguments[c];n.apply(this,u)}else if(i(n)){for(o=arguments.length,u=new Array(o-1),c=1;o>c;c++)u[c-1]=arguments[c];for(a=n.slice(),o=a.length,c=0;o>c;c++)a[c].apply(this,u)}return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned){var o;o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,s,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(u=s;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){o=u;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],25:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],26:[function(e){"use strict";var t=e("../angular"),n=(e("../index.js"),t.module("factoryng"));n.factory("DeltaPouchyng",["$q","$timeout",e("./delta-pouchyng")])},{"../angular":29,"../index.js":30,"./delta-pouchyng":27}],27:[function(e,t){"use strict";var n=e("../yng-utils"),r=e("./pouchyng-common"),o=e("delta-pouch");t.exports=function(t,i){var s=new r(t,i),u=new n(t);if("undefined"!=typeof window&&window.PouchDB)var c=window.PouchDB;else var c=e("pouchdb");return function(e,t,n){function r(e){delete e._rev,d.yng.createDoc(e)}function a(e){delete e._rev;var t=d.yng.get(e.$id),n=d.db.merge(t,e);n.$priority!==t.$priority?d.yng.moveDoc(n):d.yng.updateDoc(n)}function f(e){d.yng.removeDoc(e)}var d=new s(e,t,n,"deltapouchyng");d.copyApi(this),c.plugin(o),d.map=function(){return d.db.all().then(function(e){u.forEach(e,function(e){delete e._rev,d.yng.push(e)})})},d.registerListeners=function(){var e=f;d.db.deltaInit(),d.db.delta.on("create",r).on("update",a).on("delete",e)},this.create=function(e){return i(function(){return d.yng.setPriorityIfNeeded(e),d.db.save(e).then(function(t){return e.$id=t.$id,d.yng.push(e),e})})},this.update=function(e){return i(function(){var t=d.yng.get(e.$id);return d.db.saveChanges(t,e).then(function(n){var r=d.db.merge(t,n);return d.yng.set(r),e})})},this.remove=function(e){return i(function(){return d.db["delete"](e).then(function(e){return d.yng.remove(e.$id)})})},this.setPriority=function(e,t){return i(function(){var n=d.yng.toId(e),r=d.yng.get(n),o=u.clone(r);return o.$priority=t,d.db.saveChanges(r,o).then(function(){return d.yng.moveDoc(o),r})})},this.cleanup=function(){return d.db.cleanup()}}}},{"../yng-utils":31,"./pouchyng-common":28,"delta-pouch":4,pouchdb:1}],28:[function(e,t){"use strict";var n=e("../yng-utils"),r=e("../yng");t.exports=function(t,o){var i=new r(t,o),s=new n(t);if("undefined"!=typeof window&&window.PouchDB)var u=window.PouchDB;else var u=e("pouchdb");return function(e,n,r,c){function a(e){e&&y.yng.error(e)}function f(){y.yng.emit("uptodate")}function d(e){return function(){return y.map().then(function(){return y.yng.sortIfNeeded(),y.yng.bindModel(y.yng.scope).then(e.resolve)})}}function l(e){var t={since:e.update_seq,live:!0};t=s.merge(t,s.get(y.yng.props,"changes","opts")),y.changes=y.db.changes(t)}function h(e){var t={live:!0},n=t,r=y.yng.url+"/"+(s.get(y.yng.props,"user")?y.yng.props.user:y.yng.name);t=s.merge(t,s.get(y.yng.props,"to","opts")),n=s.merge(n,s.get(y.yng.props,"from","opts")),y.to=y.db.replicate.to(r,t,a),y.from=y.db.replicate.from(r,n,a).once("uptodate",d(e)).on("uptodate",f).once("error",d(e)).on("complete",f)}function p(){return y.db.info().then(function(e){var n=t.defer();return l(e),y.registerListeners(),h(n),n.promise})}function v(){var e=new u(y.yng.url+"/"+(s.get(y.yng.props,"user")?y.yng.props.user:y.yng.name));return s.doAndOnce(function(){return e.destroy()},"destroyed",e)}var y=this;this.yng=new i(e,n,r);var m={opts:{filter:function(e){return 0!==e._id.indexOf("_design")}}};this.yng.props={changes:m,to:m,from:m},this.db=null,this.to=null,this.from=null,this.changes=null;var g=y.yng.name+"_"+c;this.db=new u(g),this.provider=function(){return y.db},this.bind=function(e){return y.yng.bound()?y.yng.bindModel(e):(y.db.setMaxListeners(20),y.yng.scope=e,y.db.on("error",y.yng.error),o(function(){return p()}))},this.cancel=function(){y.changes&&y.changes.cancel(),y.to&&y.to.cancel(),y.from&&y.from.cancel()},this.destroy=function(e){y.cancel();var n=s.doAndOnce(function(){return y.db.destroy()},"destroyed",this.db),r=[n];return e||r.push(v()),t.all(r).then(function(){return y.yng.destroy()})},this.copyApi=function(e){y.yng.copyApi(e);var t=["provider","bind","destroy"];s.copyFns(t,y,e)}}}},{"../yng":32,"../yng-utils":31,pouchdb:1}],29:[function(e,t){e("angular"),t.exports=angular},{angular:1}],30:[function(e){"use strict";var t=e("./angular"),n=t.module("factoryng",[]);n.service("yngutils",["$q",e("./yng-utils")]),n.factory("Yng",["$q","$timeout",e("./yng")])},{"./angular":29,"./yng":32,"./yng-utils":31}],31:[function(e,t){"use strict";t.exports=function(e){this.ASC=1,this.DESC=2,this.replace=function(e,t){for(var n in e)this.notDefined(t[n])&&delete e[n];for(n in t)e[n]=t[n]},this.isString=function(e){return"string"==typeof e||e instanceof String},this.isNumeric=function(e){return!isNaN(e)},this.notDefined=function(e){return"undefined"==typeof e},this.isFunction=function(e){return"function"==typeof e},this.clone=function(e){return JSON.parse(JSON.stringify(e))},this.copyFns=function(e,t,n){e.forEach(function(e){n[e]=function(){return t[e].apply(t,arguments)}})},this.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n,e)},this.doAndOnce=function(t,n,r){var o=e.defer(),i=e.defer();return r.once(n,function(){var e=arguments;return o.promise.then(function(t){i.resolve({action:t,event:e})})}),t().then(function(){return o.resolve(arguments),i.promise})},this.merge=function(e,t){var n,r={};if(e)for(n in e)r[n]=e[n];if(t)for(n in t)r[n]=t[n];return r},this.get=function(){if(arguments&&"undefined"!=typeof arguments[0]){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];if(null===e||"undefined"==typeof e[n])return;e=e[n]}return e}}}},{}],32:[function(e,t){"use strict";var n=e("inherits"),r=e("events").EventEmitter,o=e("./yng-utils");t.exports=function(e,t){var i=0,s=new o(e),u=function(e,t,n){this.name=e,this.url=t,this.sortBy=n,this.model=[],this.map={},this.sorting=!1,this.scope=null,this.props={}};n(u,r);var c=100,a=function(e){return function(t,n){var r=t.$priority-n.$priority;return e===s.DESC?-r:r}};return u.prototype.sortIfNeeded=function(){this.sortBy&&this.model.sort(this.sortBy===s.ASC||this.sortBy===s.DESC?a(this.sortBy):this.sortBy)},u.prototype.sortSoonIfNeeded=function(){if(!this.sorting){this.sorting=!0;var e=this;t(function(){e.sortIfNeeded(),e.sorting=!1},c)}},u.prototype.get=function(e){return this.map[e]},u.prototype.at=function(e){return this.model[e]},u.prototype.set=function(e){this.exists(e.$id)&&s.replace(this.get(e.$id),e)},u.prototype.setProperty=function(e,t,n){this.map[e][t]=n},u.prototype.exists=function(e){return this.map[e]?!0:!1},u.prototype.push=function(e){this.exists(e.$id)||(this.map[e.$id]=e,this.model.push(e))},u.prototype.remove=function(e){var t=this.map[e];return t&&(this.model.splice(this.model.indexOf(t),1),delete this.map[e]),t},u.prototype.length=function(){return this.model.length},u.prototype.bindModel=function(e){var n=this;return t(function(){return n.scope=e,e[n.name]=n.model,n.model})},u.prototype.bound=function(){return this.scope&&this.scope[this.name]?!0:!1},u.prototype.applyFactory=function(e){var t=this;return function(){return e.apply(t,arguments)}},u.prototype.createDoc=function(e){var n=this;return t(function(){return n.push(e),n.emit("create",e),e})},u.prototype.updateDoc=function(e){var n=this;return t(function(){return n.set(e),n.emit("update",e),e})},u.prototype.removeDoc=function(e){var n=this;return t(function(){var t=n.toId(e),r=n.remove(t);return n.emit("remove",r),r})},u.prototype.moveDoc=function(e){var n=this;return t(function(){return n.get(e.$id).$priority!==e.$priority&&(n.set(e),n.sortSoonIfNeeded()),n.emit("move",e),e})},u.prototype.setPriorityIfNeeded=function(e){s.notDefined(e.$priority)&&(e.$priority=this.length())},u.prototype.toId=function(e){var t=s.isString(e)||s.isNumeric(e)?e:e.$id;if(s.notDefined(t))throw new Error("missing $id");return t},u.prototype.forEach=function(e,t){return this.model.forEach(e,t)},u.prototype.cleanup=function(){return e.when()},u.prototype.provider=function(){return null},u.prototype.destroy=function(){return this.removeAllListeners(),this.model=[],this.map={},e.when()},u.prototype.error=function(e){this.emit("error",e)},u.prototype.nextId=function(){return++i},u.prototype.properties=function(e){return"undefined"==typeof e?this.props:void(this.props=e)},u.prototype.copyApi=function(e){var t=["sortIfNeeded","sortSoonIfNeeded","get","at","set","setProperty","exists","push","remove","length","forEach","cleanup","provider","destroy","bound","properties","on","once","removeListener"];s.copyFns(t,this,e)},u}},{"./yng-utils":31,events:24,inherits:25}]},{},[26]);