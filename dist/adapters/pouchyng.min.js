!function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(){},{}],2:[function(e,t){t.exports=e(1)},{"/Users/geoffreycox/Documents/nobkup/factoryng/node_modules/browserify/lib/_empty.js":1}],3:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.MutationObserver,n="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var o=document.createElement("div"),i=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return i.observe(o,{attributes:!0}),function(e){r.length||o.setAttribute("yes","no"),r.push(e)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,u,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,u=new Array(o-1),c=1;o>c;c++)u[c-1]=arguments[c];n.apply(this,u)}else if(i(n)){for(o=arguments.length,u=new Array(o-1),c=1;o>c;c++)u[c-1]=arguments[c];for(a=n.slice(),o=a.length,c=0;o>c;c++)a[c].apply(this,u)}return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned){var o;o=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,o,s,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(u=s;u-->0;)if(n[u]===t||n[u].listener&&n[u].listener===t){o=u;break}if(0>o)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],5:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],6:[function(e,t,n){"use strict";function r(e){return JSON.parse(JSON.stringify(e))}function o(e,t){var n,r={};if(e)for(n in e)r[n]=e[n];if(t)for(n in t)r[n]=t[n];return r}var i=e("./pouch-utils"),s=e("events"),u=1e3,c=3e5,a=1.1;n.persist=function(e){function t(){return L.info().then(function(e){var t=O.opts.changes,n={since:e.update_seq,live:!0};t.opts&&(n=o(n,t.opts)),O.changes=L.changes(n)})}function n(e,t){t.forEach(function(t){var n=e[t.method];n.call(e,t.event,t.listener)})}function f(e){return Math.min(O.maxTimeout,Math.floor(e*O.backoff))}function p(){O.connected=!1,O.emit("disconnect")}function l(e,t){if(405===e.status){var n=N[t];n.connected=!1,n.retryTimeout=f(n.retryTimeout),setTimeout(t===O.TO?g:w,n.retryTimeout),O.connected&&p()}}function h(){O.connected=!0,O.emit("connect")}function d(e){var t=N[e];t.connected=!0,t.retryTimeout=O.startingTimeout,v(e),N[O.TO].connected&&N[O.FROM].connected&&h()}function v(e){var t=e===O.TO?O.to:O.from,n=N[e].connectListener;t.removeListener("change",n),t.removeListener("complete",n),t.removeListener("uptodate",n)}function y(e,t,r){e.on("error",function(e){l(e,t)}),N[t].connectListener=function(){d(t)};var o=N[t].connectListener;e.once("change",o).once("complete",o).once("uptodate",o),r&&n(e,r)}function m(e){var t=e===O.TO?O.opts.to:O.opts.from,n=e===O.TO?L.replicate.to:L.replicate.from,r={live:!0},i=t.url?t.url:O.opts.url;t.opts&&(r=o(r,t.opts)),e===O.TO?_():T();var s=n(i,r,t.onErr);e===O.TO?O.to=s:O.from=s,y(s,e,t.listeners)}function g(){m(O.TO)}function w(){m(O.FROM)}function b(e){N[O.TO].replicating||e!==O.BOTH&&e!==O.TO||(N[O.TO].replicating=!0,g()),N[O.FROM].replicating||e!==O.BOTH&&e!==O.FROM||(N[O.FROM].replicating=!0,w())}function E(){O.changes&&O.changes.cancel()}function _(){O.to&&O.to.cancel()}function T(){O.from&&O.from.cancel()}var L=this,O=new s.EventEmitter;O.TO=1,O.FROM=2,O.BOTH=3,O.opts={changes:{},to:{},from:{}},O.config=function(e){for(var t in e)O.opts[t]=e[t]},e&&O.config(e),O.startingTimeout=e&&e.startingTimeout?e.startingTimeout:u,O.maxTimeout=e&&e.maxTimeout?e.maxTimeout:c,O.backoff=e&&e.backoff?e.backoff:a,O.connected=!1;var x={retryTimeout:O.startingTimeout,replicating:!1,connected:!1},N={},D=!1;return N[O.TO]=x,N[O.FROM]=r(x),O.start=function(e){return e=e?e:O.BOTH,D?new i.Promise(function(){b(e)}):t().then(function(){D=!0,b(e)})},O.cancel=function(){E(),_(),T()},O.stop=function(e){e=e?e:O.BOTH,(e===O.BOTH||e===O.TO)&&(N[O.TO].replicating=!1,N[O.TO].connected=!1,_()),(e===O.BOTH||e===O.FROM)&&(N[O.FROM].replicating=!1,N[O.FROM].connected=!1,T()),N[O.TO].replicating||N[O.FROM].replicating||E(),p()},e&&!e.manual&&O.start(),O},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(n)},{"./pouch-utils":25,events:4}],7:[function(e,t){"use strict";function n(){}t.exports=n},{}],8:[function(e,t){"use strict";function n(e){function t(e,t){function r(e){a[t]=e,++f===n&!c&&(c=!0,u.resolve(l,a))}i(e).then(r,function(e){c||(c=!0,u.reject(l,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=new Array(n),f=0,p=-1,l=new r(s);++p<n;)t(e[p],p);return l}var r=e("./promise"),o=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":7,"./handlers":9,"./promise":11,"./reject":14,"./resolve":15}],9:[function(e,t,n){"use strict";function r(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var o=e("./tryCatch"),i=e("./resolveThenable"),s=e("./states");n.resolve=function(e,t){var u=o(r,t);if("error"===u.status)return n.reject(e,u.value);var c=u.value;if(c)i.safely(e,c);else{e.state=s.FULFILLED,e.outcome=t;for(var a=-1,f=e.queue.length;++a<f;)e.queue[a].callFulfilled(t)}return e},n.reject=function(e,t){e.state=s.REJECTED,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e}},{"./resolveThenable":16,"./states":17,"./tryCatch":18}],10:[function(e,t,n){t.exports=n=e("./promise"),n.resolve=e("./resolve"),n.reject=e("./reject"),n.all=e("./all"),n.race=e("./race")},{"./all":8,"./promise":11,"./race":13,"./reject":14,"./resolve":15}],11:[function(e,t){"use strict";function n(e){if(!(this instanceof n))return new n(e);if("function"!=typeof e)throw new TypeError("reslover must be a function");this.state=s.PENDING,this.queue=[],this.outcome=void 0,e!==o&&i.safely(this,e)}var r=e("./unwrap"),o=e("./INTERNAL"),i=e("./resolveThenable"),s=e("./states"),u=e("./queueItem");t.exports=n,n.prototype["catch"]=function(e){return this.then(null,e)},n.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s.FULFILLED||"function"!=typeof t&&this.state===s.REJECTED)return this;var i=new n(o);if(this.state!==s.PENDING){var c=this.state===s.FULFILLED?e:t;r(i,c,this.outcome)}else this.queue.push(new u(i,e,t));return i}},{"./INTERNAL":7,"./queueItem":12,"./resolveThenable":16,"./states":17,"./unwrap":19}],12:[function(e,t){"use strict";function n(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}var r=e("./handlers"),o=e("./unwrap");t.exports=n,n.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},n.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},n.prototype.callRejected=function(e){r.reject(this.promise,e)},n.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)}},{"./handlers":9,"./unwrap":19}],13:[function(e,t){"use strict";function n(e){function t(e){i(e).then(function(e){c||(c=!0,u.resolve(f,e))},function(e){c||(c=!0,u.reject(f,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return o(new TypeError("must be an array"));var n=e.length,c=!1;if(!n)return i([]);for(var a=-1,f=new r(s);++a<n;)t(e[a]);return f}var r=e("./promise"),o=e("./reject"),i=e("./resolve"),s=e("./INTERNAL"),u=e("./handlers");t.exports=n},{"./INTERNAL":7,"./handlers":9,"./promise":11,"./reject":14,"./resolve":15}],14:[function(e,t){"use strict";function n(e){var t=new r(o);return i.reject(t,e)}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n},{"./INTERNAL":7,"./handlers":9,"./promise":11}],15:[function(e,t){"use strict";function n(e){if(e)return e instanceof r?e:i.resolve(new r(o),e);var t=typeof e;switch(t){case"boolean":return s;case"undefined":return c;case"object":return u;case"number":return a;case"string":return f}}var r=e("./promise"),o=e("./INTERNAL"),i=e("./handlers");t.exports=n;var s=i.resolve(new r(o),!1),u=i.resolve(new r(o),null),c=i.resolve(new r(o),void 0),a=i.resolve(new r(o),0),f=i.resolve(new r(o),"")},{"./INTERNAL":7,"./handlers":9,"./promise":11}],16:[function(e,t,n){"use strict";function r(e,t){function n(t){u||(u=!0,o.reject(e,t))}function r(t){u||(u=!0,o.resolve(e,t))}function s(){t(r,n)}var u=!1,c=i(s);"error"===c.status&&n(c.value)}var o=e("./handlers"),i=e("./tryCatch");n.safely=r},{"./handlers":9,"./tryCatch":18}],17:[function(e,t,n){n.REJECTED=["REJECTED"],n.FULFILLED=["FULFILLED"],n.PENDING=["PENDING"]},{}],18:[function(e,t){"use strict";function n(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}t.exports=n},{}],19:[function(e,t){"use strict";function n(e,t,n){r(function(){var r;try{r=t(n)}catch(i){return o.reject(e,i)}r===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,r)})}var r=e("immediate"),o=e("./handlers");t.exports=n},{"./handlers":9,immediate:20}],20:[function(e,t){"use strict";function n(){o=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}o=!1}function r(e){1!==u.push(e)||o||i()}for(var o,i,s=[e("./nextTick"),e("./mutation.js"),e("./messageChannel"),e("./stateChange"),e("./timeout")],u=[],c=-1,a=s.length;++c<a;)if(s[c]&&s[c].test&&s[c].test()){i=s[c].install(n);break}t.exports=r},{"./messageChannel":21,"./mutation.js":22,"./nextTick":2,"./stateChange":23,"./timeout":24}],21:[function(e,t,n){(function(e){"use strict";n.test=function(){return e.setImmediate?!1:"undefined"!=typeof e.MessageChannel},n.install=function(t){var n=new e.MessageChannel;return n.port1.onmessage=t,function(){n.port2.postMessage(0)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,n){(function(e){"use strict";var t=e.MutationObserver||e.WebKitMutationObserver;n.test=function(){return t},n.install=function(n){var r=0,o=new t(n),i=e.document.createTextNode("");return o.observe(i,{characterData:!0}),function(){i.data=r=++r%2}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(e,t,n){(function(e){"use strict";n.test=function(){return"document"in e&&"onreadystatechange"in e.document.createElement("script")},n.install=function(t){return function(){var n=e.document.createElement("script");return n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n),t}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],24:[function(e,t,n){"use strict";n.test=function(){return!0},n.install=function(e){return function(){setTimeout(e,0)}}},{}],25:[function(e,t,n){(function(t,r){"use strict";var o;o="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof r.Promise?r.Promise:e("lie"),n.once=function(e){var t=!1;return n.getArguments(function(n){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,n)})},n.getArguments=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}},n.toPromise=function(e){return n.getArguments(function(r){var i,s=this,u="function"==typeof r[r.length-1]?r.pop():!1;u&&(i=function(e,n){t.nextTick(function(){u(e,n)})});var c=new o(function(t,o){try{var i=n.once(function(e,n){e?o(e):t(n)});r.push(i),e.apply(s,r)}catch(u){o(u)}});return i&&c.then(function(e){i(null,e)},i),c.cancel=function(){return this},c})},n.inherits=e("inherits"),n.Promise=o}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3,inherits:5,lie:10}],26:[function(e,t){"use strict";var n=e("../yng-utils"),r=e("../yng"),o=e("pouchdb-persist");t.exports=function(t,i){var s=new r(t,i),u=new n(t);if("undefined"!=typeof window&&window.PouchDB)var c=window.PouchDB;else var c=e("pouchdb");return c.plugin(o),function(e,n,r,o){function a(e){e&&v.yng.error(e)}function f(){v.yng.emit("uptodate")}function p(e){return function(){return v.map().then(function(){return v.yng.sortIfNeeded(),v.yng.bindModel(v.yng.scope).then(e.resolve)})}}function l(e){return[{method:"once",event:"uptodate",listener:p(e)},{method:"on",event:"uptodate",listener:f},{method:"once",event:"error",listener:p(e)},{method:"on",event:"complete",listener:f}]}function h(){var e=t.defer();return v.persist=v.db.persist({url:v.yng.url+"/"+(u.get(v.yng.props,"user")?v.yng.props.user:v.yng.name),manual:!0,changes:{opts:u.get(v.yng.props,"changes","opts")},to:{opts:u.get(v.yng.props,"to","opts"),onErr:a},from:{opts:u.get(v.yng.props,"from","opts"),onErr:a,listeners:l(e)}}),v.registerListeners(),v.persist.start(),e.promise}function d(){var e=new c(v.yng.url+"/"+(u.get(v.yng.props,"user")?v.yng.props.user:v.yng.name));return u.doAndOnce(function(){return e.destroy()},"destroyed",e)}var v=this;this.yng=new s(e,n,r);var y={opts:{filter:function(e){return 0!==e._id.indexOf("_design")}}};this.yng.props={changes:y,to:y,from:y},this.db=null,this.persist=null;var m=v.yng.name+"_"+o;this.db=new c(m),this.provider=function(){return v.db},this.bind=function(e){return v.yng.bound()?v.yng.bindModel(e):(v.db.setMaxListeners(20),v.yng.scope=e,v.db.on("error",v.yng.error),i(function(){return h()}))},this.cancel=function(){this.persist.cancel()},this.destroy=function(e){v.cancel();var n=u.doAndOnce(function(){return v.db.destroy()},"destroyed",this.db),r=[n];return e||r.push(d()),t.all(r).then(function(){return v.yng.destroy()})},this.copyApi=function(e){v.yng.copyApi(e);var t=["provider","bind","destroy"];u.copyFns(t,v,e)}}}},{"../yng":32,"../yng-utils":31,pouchdb:1,"pouchdb-persist":6}],27:[function(e){"use strict";var t=e("../angular"),n=(e("../index.js"),t.module("factoryng"));n.factory("Pouchyng",["$q","$timeout",e("./pouchyng")])},{"../angular":29,"../index.js":30,"./pouchyng":28}],28:[function(e,t){"use strict";var n=e("../yng-utils"),r=e("./pouchyng-common");t.exports=function(e,t){var o=new r(e,t),i=new n(e);return function(e,n,r){function s(e){return e.$id=e._id,e}function u(e){f.yng.createDoc(s(e.doc))}function c(e){var t=s(e.doc),n=f.yng.get(t.$id);n?t.$priority!==n.$priority?f.yng.moveDoc(t):f.yng.updateDoc(t):f.yng.createDoc(t)}function a(e){f.yng.removeDoc(e.doc._id)}var f=new o(e,n,r,"pouchyng");f.copyApi(this),f.map=function(){return f.db.allDocs({include_docs:!0}).then(function(e){e.rows.forEach(function(e){e.doc.$id=e.id,f.yng.push(e.doc)})})},f.registerListeners=function(){var e=a;f.db.on("create",u).on("update",c).on("delete",e)},this.create=function(e){return t(function(){return f.yng.setPriorityIfNeeded(e),f.db.post(e).then(function(t){return e.$id=t.id,e._id=t.id,e._rev=t.rev,f.yng.push(e),e})})},this.update=function(e){return t(function(){e._id=e.$id;var t=i.clone(e);return delete t.$id,f.db.put(t).then(function(t){return e._rev=t.rev,f.yng.set(e),e})})},this.remove=function(e){return t(function(){var t=f.yng.toId(e),n=f.yng.get(t);return f.db.remove(n).then(function(){return f.yng.remove(t)})})},this.setPriority=function(e,n){return t(function(){var t=f.yng.toId(e),r=f.yng.get(t);r.$priority=n,r._id=r.$id;var o=i.clone(r);return delete o.$id,f.db.put(o).then(function(e){return r._rev=e.rev,f.yng.moveDoc(r),r})})}}}},{"../yng-utils":31,"./pouchyng-common":26}],29:[function(e,t){e("angular"),t.exports=angular},{angular:1}],30:[function(e){"use strict";var t=e("./angular"),n=t.module("factoryng",[]);n.service("yngutils",["$q",e("./yng-utils")]),n.factory("Yng",["$q","$timeout",e("./yng")])},{"./angular":29,"./yng":32,"./yng-utils":31}],31:[function(e,t){"use strict";t.exports=function(e){this.ASC=1,this.DESC=2,this.replace=function(e,t){for(var n in e)this.notDefined(t[n])&&delete e[n];for(n in t)e[n]=t[n]},this.isString=function(e){return"string"==typeof e||e instanceof String},this.isNumeric=function(e){return!isNaN(e)},this.notDefined=function(e){return"undefined"==typeof e},this.isFunction=function(e){return"function"==typeof e},this.clone=function(e){return JSON.parse(JSON.stringify(e))},this.copyFns=function(e,t,n){e.forEach(function(e){n[e]=function(){return t[e].apply(t,arguments)}})},this.forEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n,e)},this.doAndOnce=function(t,n,r){var o=e.defer(),i=e.defer();return r.once(n,function(){var e=arguments;return o.promise.then(function(t){i.resolve({action:t,event:e})})}),t().then(function(){return o.resolve(arguments),i.promise})},this.merge=function(e,t){var n,r={};if(e)for(n in e)r[n]=e[n];if(t)for(n in t)r[n]=t[n];return r},this.get=function(){if(arguments&&"undefined"!=typeof arguments[0]){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];if(null===e||"undefined"==typeof e[n])return;e=e[n]}return e}}}},{}],32:[function(e,t){"use strict";var n=e("inherits"),r=e("events").EventEmitter,o=e("./yng-utils");t.exports=function(e,t){var i=0,s=new o(e),u=function(e,t,n){this.name=e,this.url=t,this.sortBy=n,this.model=[],this.map={},this.sorting=!1,this.scope=null,this.props={}};n(u,r);var c=100,a=function(e){return function(t,n){var r=t.$priority-n.$priority;return e===s.DESC?-r:r}};return u.prototype.sortIfNeeded=function(){this.sortBy&&this.model.sort(this.sortBy===s.ASC||this.sortBy===s.DESC?a(this.sortBy):this.sortBy)},u.prototype.sortSoonIfNeeded=function(){if(!this.sorting){this.sorting=!0;var e=this;t(function(){e.sortIfNeeded(),e.sorting=!1},c)}},u.prototype.get=function(e){return this.map[e]},u.prototype.at=function(e){return this.model[e]},u.prototype.set=function(e){this.exists(e.$id)&&s.replace(this.get(e.$id),e)},u.prototype.setProperty=function(e,t,n){this.map[e][t]=n},u.prototype.exists=function(e){return this.map[e]?!0:!1},u.prototype.push=function(e){this.exists(e.$id)||(this.map[e.$id]=e,this.model.push(e))},u.prototype.remove=function(e){var t=this.map[e];return t&&(this.model.splice(this.model.indexOf(t),1),delete this.map[e]),t},u.prototype.length=function(){return this.model.length},u.prototype.bindModel=function(e){var n=this;return t(function(){return n.scope=e,e[n.name]=n.model,n.model})},u.prototype.bound=function(){return this.scope&&this.scope[this.name]?!0:!1},u.prototype.applyFactory=function(e){var t=this;return function(){return e.apply(t,arguments)}},u.prototype.createDoc=function(e){var n=this;return t(function(){return n.push(e),n.emit("create",e),e})},u.prototype.updateDoc=function(e){var n=this;return t(function(){return n.set(e),n.emit("update",e),e})},u.prototype.removeDoc=function(e){var n=this;return t(function(){var t=n.toId(e),r=n.remove(t);return n.emit("remove",r),r})},u.prototype.moveDoc=function(e){var n=this;return t(function(){return n.get(e.$id).$priority!==e.$priority&&(n.set(e),n.sortSoonIfNeeded()),n.emit("move",e),e})},u.prototype.setPriorityIfNeeded=function(e){s.notDefined(e.$priority)&&(e.$priority=this.length())},u.prototype.toId=function(e){var t=s.isString(e)||s.isNumeric(e)?e:e.$id;if(s.notDefined(t))throw new Error("missing $id");return t},u.prototype.forEach=function(e,t){return this.model.forEach(e,t)},u.prototype.cleanup=function(){return e.when()},u.prototype.provider=function(){return null},u.prototype.destroy=function(){return this.removeAllListeners(),this.model=[],this.map={},e.when()},u.prototype.error=function(e){this.emit("error",e)},u.prototype.nextId=function(){return++i},u.prototype.properties=function(e){return"undefined"==typeof e?this.props:void(this.props=e)},u.prototype.copyApi=function(e){var t=["sortIfNeeded","sortSoonIfNeeded","get","at","set","setProperty","exists","push","remove","length","forEach","cleanup","provider","destroy","bound","properties","on","once","removeListener"];s.copyFns(t,this,e)},u}},{"./yng-utils":31,events:4,inherits:5}]},{},[27]);